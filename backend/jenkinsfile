pipeline {
	agent any
      
	stages {

        stage('maven'){
            steps{
                sh "mvn --version"
            }

        }
        stage('Compile'){
            steps {
                dir("backend"){
                    sh "mvn clean compile"
                }
            }
        }
		stage('Package'){
			steps {
                dir("backend") {
                    sh "mvn package -DskipTests=true"
				    archive 'target/*.jar'
                }
				
			}
		}
       stage('JUnit')
        {
			steps 
            {
          		      dir("backend") 
                      {
                 		 sh "mvn test"
		 		         
                      }
			}
		}
      
	/*	stage('sonarqube'){
			steps{
                dir("backend") {
				    withSonarQubeEnv(installationName: 'sonar'){
				    sh "mvn sonar:sonar"
				    }
                }
			}
		} */
     /*   stage('deploy'){
            steps{
                dir("backend") {
                    sh "mvn deploy"
                }
            }
        }*/
       stage('Docker image') 
        {
            steps 
            {
               dir("backend") 
               {
                 script{
                 docker.build('nour/achat:$BUILD_NUMBER')
                 }
               }
            }
        }
	}
}
